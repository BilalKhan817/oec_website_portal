<div class="menu-management-container">
  <div class="header">
    <h1>Menu Management</h1>
    <button mat-raised-button color="primary" (click)="openDialog()">
      <mat-icon>add</mat-icon>
      Add Menu Item
    </button>
  </div>

  <mat-card>
    <mat-card-content>
      <div *ngIf="loading" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>

      <div *ngIf="!loading && menuItems.length === 0" class="no-data">
        <mat-icon>menu</mat-icon>
        <p>No menu items found. Click "Add Menu Item" to get started.</p>
      </div>

      <table mat-table [dataSource]="menuItems" *ngIf="!loading && menuItems.length > 0"
             cdkDropList (cdkDropListDropped)="drop($event)" class="menu-table">

        <!-- Drag Handle Column -->
        <ng-container matColumnDef="drag">
          <th mat-header-cell *matHeaderCellDef width="50"></th>
          <td mat-cell *matCellDef="let element" cdkDrag>
            <mat-icon class="drag-handle" cdkDragHandle>drag_indicator</mat-icon>
          </td>
        </ng-container>

        <!-- Order Column -->
        <ng-container matColumnDef="order">
          <th mat-header-cell *matHeaderCellDef width="80">Order</th>
          <td mat-cell *matCellDef="let element">{{ element.order }}</td>
        </ng-container>

        <!-- Title Column -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef>Title</th>
          <td mat-cell *matCellDef="let element">
            <strong>{{ element.title }}</strong>
          </td>
        </ng-container>

        <!-- Icon Column -->
        <ng-container matColumnDef="icon">
          <th mat-header-cell *matHeaderCellDef width="100">Icon</th>
          <td mat-cell *matCellDef="let element">
            <i [class]="element.icon"></i>
            <span class="icon-class">{{ element.icon }}</span>
          </td>
        </ng-container>

        <!-- Has Dropdown Column -->
        <ng-container matColumnDef="has_dropdown">
          <th mat-header-cell *matHeaderCellDef width="120">Dropdown</th>
          <td mat-cell *matCellDef="let element">
            <mat-chip *ngIf="element.has_dropdown" color="accent" selected>Yes</mat-chip>
            <mat-chip *ngIf="!element.has_dropdown">No</mat-chip>
          </td>
        </ng-container>

        <!-- Dropdown Type Column -->
        <ng-container matColumnDef="dropdown_type">
          <th mat-header-cell *matHeaderCellDef width="150">Type</th>
          <td mat-cell *matCellDef="let element">
            {{ getDropdownTypeDisplay(element.dropdown_type) }}
          </td>
        </ng-container>

        <!-- Active Status Column -->
        <ng-container matColumnDef="is_active">
          <th mat-header-cell *matHeaderCellDef width="100">Status</th>
          <td mat-cell *matCellDef="let element">
            <mat-slide-toggle
              [checked]="element.is_active"
              (change)="toggleActive(element)"
              color="primary">
            </mat-slide-toggle>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef width="150">Actions</th>
          <td mat-cell *matCellDef="let element">
            <button mat-icon-button color="primary" (click)="openDialog(element)" matTooltip="Edit">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteMenuItem(element)" matTooltip="Delete">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="menu-row"></tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>
